import{v as s,p as m,S as h}from"./core-demo-header-component-Cswgyrdi.js";/* empty css                        */function r(i,t,e){return(t=E(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function R(i,t){if(typeof i!="object"||!i)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var l=e.call(i,t||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function E(i){var t=R(i,"string");return typeof t=="symbol"?t:t+""}const N=s.getPlugin("plugin"),c=s.log.createLogger("pillarbox-playlist");class T extends N{toggleRepeat(t=void 0){this.repeat=t??!this.repeat}toggleAutoadvance(t=void 0){this.autoadvance=t??!this.autoadvance}constructor(t,e){super(t),r(this,"items_",[]),r(this,"currentIndex_",-1),r(this,"repeat",!1),r(this,"autoadvance",!1),r(this,"onEnded_",()=>this.handleEnded()),e.playlist&&e.playlist.length&&t.ready(()=>{this.load(...e.playlist)}),this.autoadvance=!!e.autoadvance,this.repeat=!!e.repeat,this.player.on("ended",this.onEnded_)}dispose(){this.player.off("ended",this.onEnded_)}load(t){this.items_=[...t],this.select(0)}push(...t){this.items_.push(...t),this.updateState_()}splice(t,e,...l){const n=l.length,a=this.items_.splice(t,e,...l),d=a.length;return this.currentIndex_>=t&&this.currentIndex_<t+d?this.currentIndex_=-1:this.currentIndex_>=t&&(this.currentIndex_=this.currentIndex_-d+n),this.updateState_(),a}clear(){this.items_=[],this.currentIndex_=-1,this.updateState_()}get currentIndex(){return this.currentIndex_}get currentItem(){return this.items_[this.currentIndex_]}get items(){return[...this.items_]}select(t){if(t<0||t>=this.items_.length){c.warn(`Index: ${t} is out of bounds (The current playlist has ${this.items_.length} elements)`);return}if(t===this.currentIndex_){c.warn(`Index: ${t} is already selected`);return}const e=this.items_[t];this.player.src(e.sources),this.player.poster(e.poster),this.currentIndex_=t,this.updateState_()}next(){if(this.hasNext()){this.select(this.currentIndex_+1);return}this.repeat&&this.select(0)}hasNext(){return this.currentIndex_+1<this.items_.length}previous(){this.select(this.currentIndex_-1)}hasPrevious(){return this.currentIndex_>0}handleEnded(){this.autoadvance&&this.next()}shuffle(){for(let t=this.items_.length-1;t>0;t-=1){const e=Math.floor(Math.random()*(t+1));[this.items_[t],this.items_[e]]=[this.items_[e],this.items_[t]],this.currentIndex_===t?this.currentIndex_=e:this.currentIndex_===e&&(this.currentIndex_=t)}this.updateState_()}updateState_(){this.setState({items:JSON.stringify(this.items_),currentIndex:this.currentIndex_})}}s.registerPlugin("pillarboxPlaylist",T);function y(i,t,e){return(t=O(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function L(i,t){if(typeof i!="object"||!i)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var l=e.call(i,t||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function O(i){var t=L(i,"string");return typeof t=="symbol"?t:t+""}const z=s.getComponent("Button");let k=class extends z{constructor(t,e){var l,n;super(t,e),this.selected(e.index===this.playlist().currentIndex),this.controlText(`${(l=this.options_.item.data)===null||l===void 0?void 0:l.title} - ${s.formatTime((n=this.options_.item.data)===null||n===void 0?void 0:n.duration)}`)}playlist(){return this.player().pillarboxPlaylist()}handleClick(t){super.handleClick(t),this.playlist().select(this.options_.index)}selected(t){this.toggleClass("vjs-selected",t)}buildCSSClass(){return`pbw-playlist-item-button vjs-visible-text ${super.buildCSSClass()}`}};s.registerComponent("PillarboxPlaylistMenuItem",k);const D=s.getComponent("PillarboxPlaylistMenuItem"),o=s.getComponent("Button"),u=s.getComponent("Component"),H=s.getComponent("ModalDialog");class U extends H{constructor(t,e){e.temporary=!1,super(t,e),y(this,"_onPlaylistStateChanged",({changes:l})=>{"items"in l&&(this.removeItems(),this.renderItems()),"currentIndex"in l&&this.select(l.currentIndex.to)}),this.fill(),this.renderComponent(),this.playlist().on("statechanged",this._onPlaylistStateChanged)}buildCSSClass(){return`pbw-playlist-dialog ${super.buildCSSClass()}`}dispose(){this.playlist().off("statechanged",this._onPlaylistStateChanged),super.dispose()}playlist(){return this.player().pillarboxPlaylist()}select(t){this.getChild("PillarboxPlaylistMenuItemsList").children().filter(l=>l.name()==="PillarboxPlaylistMenuItem").map(l=>l.getChild("PillarboxPlaylistMenuItemButton")).forEach(l=>l.selected(t===l.options().index))}removeItems(){this.removeChild(this.getChild("PillarboxPlaylistMenuItemsList"))}renderItems(){const t=new u(this.player(),{name:"PillarboxPlaylistMenuItemsList",el:s.dom.createEl("ol",{className:"pbw-playlist-items"})});this.playlist().items.forEach((e,l)=>{const n=new u(this.player(),{name:"PillarboxPlaylistMenuItem",el:s.dom.createEl("li",{className:"pbw-playlist-item"})});n.addChild(new D(this.player(),{item:e,index:l,name:"PillarboxPlaylistMenuItemButton"})),t.addChild(n)}),this.addChild(t)}createControls(){const t=new u(this.player(),{name:"PlaylistControls",className:"pbw-playlist-controls"});return t.addChild(this.createRepeatButton()),t.addChild(this.createSuffleButton()),t.addChild(this.createPreviousItemButton()),t.addChild(this.createNextItemButton()),t}createPreviousItemButton(){return this.setButtonIcon(new o(this.player(),{name:"PreviousItemButton",controlText:this.localize("Previous Item"),clickHandler:()=>this.playlist().previous()}),"previous-item")}createRepeatButton(){const t=this.setButtonIcon(new o(this.player(),{name:"RepeatButton",controlText:this.localize("Repeat"),className:this.playlist().repeat?"vjs-selected":"",clickHandler:()=>{this.playlist().toggleRepeat(),t.toggleClass("vjs-selected",this.playlist().repeat)}}),"repeat");return t}createSuffleButton(){return this.setButtonIcon(new o(this.player(),{name:"ShuffleButton",controlText:this.localize("Shuffle"),clickHandler:()=>this.playlist().shuffle()}),"shuffle")}createNextItemButton(){return this.setButtonIcon(new o(this.player(),{name:"NextItemButton",controlText:this.localize("Next Item"),clickHandler:()=>this.playlist().next()}),"next-item")}setButtonIcon(t,e){return t.setIcon(e),this.player().ready(()=>{t.$(".vjs-icon-placeholder").classList.toggle(`vjs-icon-${e}`,!0)}),t}renderComponent(){this.addChild(this.createControls()),this.renderItems()}handleLanguagechange(){const t=this.getChild("PlaylistControls");t.getChild("PreviousItemButton").controlText(this.localize("Previous Item")),t.getChild("RepeatButton").controlText(this.localize("Repeat")),t.getChild("ShuffleButton").controlText(this.localize("Shuffle")),t.getChild("NextItemButton").controlText(this.localize("Next Item"))}}s.registerComponent("PlaylistMenuDialog",U);const f="Wiedergabeliste",g="Wiederholen",P="Mischen",V={"Next Item":"Nächstes Element",Playlist:f,"Previous Item":"Vorheriges Element",Repeat:g,Shuffle:P},A=Object.freeze(Object.defineProperty({__proto__:null,Playlist:f,Repeat:g,Shuffle:P,default:V},Symbol.toStringTag,{value:"Module"})),x="Playlist",_="Repeat",b="Shuffle",K={"Next Item":"Next Item",Playlist:x,"Previous Item":"Previous Item",Repeat:_,Shuffle:b},W=Object.freeze(Object.defineProperty({__proto__:null,Playlist:x,Repeat:_,Shuffle:b,default:K},Symbol.toStringTag,{value:"Module"})),v="Liste de lecture",I="Répéter",C="Mélanger",q={"Next Item":"Élément suivant",Playlist:v,"Previous Item":"Élément précédent",Repeat:I,Shuffle:C},G=Object.freeze(Object.defineProperty({__proto__:null,Playlist:v,Repeat:I,Shuffle:C,default:q},Symbol.toStringTag,{value:"Module"})),S="Playlist",B="Ripeti",$="Mescola",J={"Next Item":"Elemento successivo",Playlist:S,"Previous Item":"Elemento precedente",Repeat:B,Shuffle:$},F=Object.freeze(Object.defineProperty({__proto__:null,Playlist:S,Repeat:B,Shuffle:$,default:J},Symbol.toStringTag,{value:"Module"})),M="Glista da reprodukziun",w="Repeter",j="Maschadar",Q={"Next Item":"Element proxim",Playlist:M,"Previous Item":"Element precedent",Repeat:w,Shuffle:j},X=Object.freeze(Object.defineProperty({__proto__:null,Playlist:M,Repeat:w,Shuffle:j,default:Q},Symbol.toStringTag,{value:"Module"}));s.addLanguage("de",A);s.addLanguage("en",W);s.addLanguage("fr",G);s.addLanguage("it",F);s.addLanguage("rm",X);const Y=s.getComponent("Button");class Z extends Y{constructor(t,e){super(t,e),y(this,"_onPlaylistStateChanged",({changes:l})=>{"items"in l&&this.toggleVisibility()}),this.handleLanguagechange(),this.setIcon("chapters"),t.ready(()=>{this.$(".vjs-icon-placeholder").classList.toggle("vjs-icon-chapters",!0),t.addChild("PlaylistMenuDialog",{pauseOnOpen:!1})}),this.playlist().on("statechanged",this._onPlaylistStateChanged)}dispose(){this.playlist().off("statechanged",this._onPlaylistStateChanged),super.dispose()}playlist(){return this.player().pillarboxPlaylist()}buildCSSClass(){return`pbw-playlist-button vjs-hidden ${super.buildCSSClass()}`}handleClick(t){super.handleClick(t),this.player().getChild("PlaylistMenuDialog").open()}handleLanguagechange(){this.controlText(this.localize("Playlist"))}toggleVisibility(){if(this.playlist().items.length>0){this.show();return}this.hide()}}s.registerComponent("PillarboxPlaylistButton",Z);const tt=s.getPlugin("plugin");class et extends tt{constructor(t,e){super(t),t.ready(function(){if(!e.insertChildBefore){t.controlBar.addChild("PillarboxPlaylistButton");return}const l=t.controlBar,n=l.getChild(e.insertChildBefore),a=l.children().indexOf(n);l.addChild("PillarboxPlaylistButton",{},a)})}}s.registerPlugin("pillarboxPlaylistUI",et);const p=m("video-element-id",{autoplay:!0,plugins:{pillarboxPlaylist:{autoadvance:!0,repeat:!0},pillarboxPlaylistUI:{insertChildBefore:"fullscreenToggle"}}}),it=["urn:rts:video:14827742","urn:srf:video:05457f66-fd67-4131-8e0a-6d85743efc39","urn:rtr:video:33136b80-bec6-40cd-a771-b8954c805098","urn:rts:video:9883196"];Promise.all(it.map(async i=>{const e=(await h.getMediaComposition(i,h.dataProvider(p))).getMainChapter();return{sources:[{src:i,type:"srgssr/urn"}],data:{title:e.title,duration:e.duration/1e3},poster:e.imageUrl}})).then(i=>{p.pillarboxPlaylist().load(i)});document.querySelector("#close-btn").addEventListener("click",()=>{window.close()});window.pillarbox=m;
//# sourceMappingURL=playlist-B-pb1ooi.js.map
