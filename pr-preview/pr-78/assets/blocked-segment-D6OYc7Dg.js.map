{"version":3,"file":"blocked-segment-D6OYc7Dg.js","sources":["../../static/showcases/blocked-segment.html?html-proxy&index=0.js","../../static/showcases/blocked-segment.html?html-proxy&index=1.js"],"sourcesContent":["\n  // Import the pillarbox library\n  import pillarbox from '@srgssr/pillarbox-web';\n\n  const Plugin = pillarbox.getPlugin('plugin');\n\n  // A Pillarbox plugin to display a blocked segment notification.\n  class BlockedSegmentNotification extends Plugin {\n    // Reference to the component used to display the blocked segment notification.\n    #component;\n    // The id for the timeout function responsible for managing the auto-hide of the notification.\n    #timeoutId;\n\n    /**\n     *\n     * @param player {import('@srgssr/pillarbox-web').Player}\n     * @param options\n     */\n    constructor(player, options) {\n      super(player, options);\n\n      // Attach the DOM element when the player is ready,\n      this.player.ready(() => this.#attachComponent());\n      // Wait for the blocked segment change event.\n      this.player.on('srgssr/blocked-segment', ({ data }) => this.#handleBlockedSegmentChange(data));\n    }\n\n    #attachComponent() {\n      this.#component = player.addChild('component', {\n        // Set the class for styling and hide the element with 'vjs-hidden'\n        className: 'pbw-blocked-segment-notification vjs-hidden'\n      });\n    }\n\n    async #handleBlockedSegmentChange(data) {\n      // Cancel the previous timeout\n      clearTimeout(this.#timeoutId);\n\n      // Parse the JSON content of the active cue to get the blocked segment information\n      const blockSegment = JSON.parse(data.text);\n      const blockReason = blockSegment.blockReason ?? 'UNKNOWN';\n      // Block reasons are localized out of the box, alternatively you can make your own\n      const message = this.#component.localize(blockReason);\n\n      // Update the displayed notification text with the appropriate message\n      this.#component.el().textContent = `â“˜ ${message}`;\n\n      // Show the blocked segment notification\n      this.#component.show();\n\n      // Set a timeout to hide the notification after a specified delay\n      this.#timeoutId = setTimeout(() => {\n        this.#component.hide();\n        this.#timeoutId = undefined;\n      }, this.options.delay);\n    }\n\n    // Get the options of this plugin\n    get options() {\n      return this.player.options().plugins.blockedSegmentNotification;\n    }\n  }\n\n  // Register a plugin to display notifications on blocked segments\n  pillarbox.registerPlugin('blockedSegmentNotification', BlockedSegmentNotification);\n\n  // Create a pillarbox player instance with the blockedSegmentNotification plugin\n  const player = pillarbox(\n    'video-element-id', {\n      muted: true,\n      plugins: {\n        blockedSegmentNotification: {\n          delay: 5000, // Delay in milliseconds before hiding the notification\n        }\n      }\n    }\n  );\n\n  // Load the video source for the player\n  player.src({ src: 'urn:srf:video:40ca0277-0e53-4312-83e2-4710354ff53e', type: 'srgssr/urn' });\n","\n  import pillarbox from '@srgssr/pillarbox-web';\n  import '../../src/layout/header/core-demo-header-component.js';\n\n  document.querySelector('#close-btn').addEventListener('click', () => {\n    window.close();\n  });\n\n  window.pillarbox = pillarbox;\n"],"names":["Plugin","pillarbox","BlockedSegmentNotification","#component","#timeoutId","player","options","#attachComponent","data","#handleBlockedSegmentChange","blockReason","message"],"mappings":"6DAIE,MAAMA,EAASC,EAAU,UAAU,QAAQ,EAG3C,MAAMC,UAAmCF,CAAO,CAE9CG,GAEAC,GAOA,YAAYC,EAAQC,EAAS,CAC3B,MAAMD,EAAQC,CAAO,EAGrB,KAAK,OAAO,MAAM,IAAM,KAAKC,GAAgB,CAAE,EAE/C,KAAK,OAAO,GAAG,yBAA0B,CAAC,CAAE,KAAAC,CAAI,IAAO,KAAKC,GAA4BD,CAAI,CAAC,CAC/F,CAEAD,IAAmB,CACjB,KAAKJ,GAAaE,EAAO,SAAS,YAAa,CAE7C,UAAW,6CACnB,CAAO,CACH,CAEA,KAAMI,GAA4BD,EAAM,CAEtC,aAAa,KAAKJ,EAAU,EAI5B,MAAMM,EADe,KAAK,MAAMF,EAAK,IAAI,EACR,aAAe,UAE1CG,EAAU,KAAKR,GAAW,SAASO,CAAW,EAGpD,KAAKP,GAAW,GAAE,EAAG,YAAc,KAAKQ,CAAO,GAG/C,KAAKR,GAAW,KAAI,EAGpB,KAAKC,GAAa,WAAW,IAAM,CACjC,KAAKD,GAAW,KAAI,EACpB,KAAKC,GAAa,MACpB,EAAG,KAAK,QAAQ,KAAK,CACvB,CAGA,IAAI,SAAU,CACZ,OAAO,KAAK,OAAO,QAAO,EAAG,QAAQ,0BACvC,CACJ,CAGEH,EAAU,eAAe,6BAA8BC,CAA0B,EAGjF,MAAMG,EAASJ,EACb,mBAAoB,CAClB,MAAO,GACP,QAAS,CACP,2BAA4B,CAC1B,MAAO,GACjB,CACA,CACA,CACA,EAGEI,EAAO,IAAI,CAAE,IAAK,qDAAsD,KAAM,aAAc,EC3E5F,SAAS,cAAc,YAAY,EAAE,iBAAiB,QAAS,IAAM,CACnE,OAAO,MAAK,CACd,CAAC,EAED,OAAO,UAAYJ"}