{"version":3,"file":"blocked-segment-DpNNMIOU.js","sources":["../../static/showcases/blocked-segment.html?html-proxy&index=0.js","../../static/showcases/blocked-segment.html?html-proxy&index=1.js"],"sourcesContent":["\n  // Import the pillarbox library\n  import pillarbox from '@srgssr/pillarbox-web';\n\n  // Register a plugin to display notifications on blocked segments\n  pillarbox.registerPlugin('blockedSegmentNotification', function(options) {\n    // Get a reference to the player instance\n    const player = this;\n\n    // Wait for the player to be ready\n    player.ready(() => {\n      // Create a component for displaying the blocked segment notification\n      const blockSegmentNotification = player.addChild('component', {\n        // Set the class for styling and hide the element with 'vjs-hidden'\n        className: 'pbw-blocked-segment-notification vjs-hidden'\n      });\n\n      // Variable to store the timeout ID for clearing later\n      let timeoutId = undefined;\n\n      // Listen for the 'loadeddata' event on the player, this ensures that text tracks are available\n      player.on('loadeddata', () => {\n        // Get the text track with the ID 'srgssr-blocked-segments'\n        const blockedSegments = player.textTracks().getTrackById('srgssr-blocked-segments');\n\n        // Add a listener for the 'cuechange' event on the blocked segments text track\n        blockedSegments?.on('cuechange', () => {\n          // Check if there are active cues in the blocked segments text track\n          if (blockedSegments.activeCues.length > 0) {\n            // Cancel the previous timeout\n            clearTimeout(timeoutId);\n\n            // Parse the JSON content of the active cue to get the blocked segment information\n            const blockSegment = JSON.parse(blockedSegments.activeCues[0].text);\n            const blockReason = blockSegment.blockReason ?? 'UNKNOWN';\n            // Block reasons are localized out of the box, alternatively you can make your own\n            const message = blockSegmentNotification.localize(blockReason);\n\n            // Update the displayed notification text with the appropriate message\n            blockSegmentNotification.el().textContent = `â“˜ ${message}`\n\n            // Show the blocked segment notification\n            blockSegmentNotification.show();\n\n            // Set a timeout to hide the notification after a specified delay\n            timeoutId = setTimeout(() => {\n              blockSegmentNotification.hide();\n              timeoutId = undefined;\n            }, options.delay);\n          }\n        });\n      });\n    });\n  });\n\n  // Create a pillarbox player instance with the blockedSegmentNotification plugin\n  const player = pillarbox(\n    'video-element-id', {\n      fill: true,\n      plugins: {\n        blockedSegmentNotification: {\n          delay: 5000, // Delay in milliseconds before hiding the notification\n        }\n      }\n    }\n  );\n\n  // Load the video source for the player\n  player.src({ src: 'urn:rts:video:10894383', type: 'srgssr/urn' });\n","\n  import pillarbox from '@srgssr/pillarbox-web';\n  import '../../src/layout/header/core-demo-header-component.js';\n\n  document.querySelector('#close-btn').addEventListener('click', () => {\n    window.close();\n  });\n\n  window.pillarbox = pillarbox;\n"],"names":["pillarbox","options","player","blockSegmentNotification","timeoutId","blockedSegments","blockReason","message"],"mappings":"mGAKEA,EAAU,eAAe,6BAA8B,SAASC,EAAS,CAEvE,MAAMC,EAAS,KAGfA,EAAO,MAAM,IAAM,CAEjB,MAAMC,EAA2BD,EAAO,SAAS,YAAa,CAE5D,UAAW,6CACnB,CAAO,EAGD,IAAIE,EAGJF,EAAO,GAAG,aAAc,IAAM,CAE5B,MAAMG,EAAkBH,EAAO,WAAY,EAAC,aAAa,yBAAyB,EAGlFG,GAAA,MAAAA,EAAiB,GAAG,YAAa,IAAM,CAErC,GAAIA,EAAgB,WAAW,OAAS,EAAG,CAEzC,aAAaD,CAAS,EAItB,MAAME,EADe,KAAK,MAAMD,EAAgB,WAAW,CAAC,EAAE,IAAI,EACjC,aAAe,UAE1CE,EAAUJ,EAAyB,SAASG,CAAW,EAG7DH,EAAyB,GAAE,EAAG,YAAc,KAAKI,CAAO,GAGxDJ,EAAyB,KAAI,EAG7BC,EAAY,WAAW,IAAM,CAC3BD,EAAyB,KAAI,EAC7BC,EAAY,MAC1B,EAAeH,EAAQ,KAAK,CACjB,CACX,EACA,CAAO,CACP,CAAK,CACL,CAAG,EAGD,MAAMC,EAASF,EACb,mBAAoB,CAClB,KAAM,GACN,QAAS,CACP,2BAA4B,CAC1B,MAAO,GACR,CACF,CACF,CACL,EAGEE,EAAO,IAAI,CAAE,IAAK,yBAA0B,KAAM,aAAc,EChEhE,SAAS,cAAc,YAAY,EAAE,iBAAiB,QAAS,IAAM,CACnE,OAAO,MAAK,CAChB,CAAG,EAED,OAAO,UAAYF"}