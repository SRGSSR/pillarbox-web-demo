import{v as u,p as _}from"./core-demo-header-component-1irpUQGc.js";/*! @name videojs-contrib-quality-menu @version 1.0.3 @license Apache-2.0 */const m=u.getComponent("MenuItem"),p=u.dom||u;class c extends m{constructor(e,t={}){const s=t.selected;t.selected=t.active,super(e,t);const l=e.qualityLevels();this.levels_=t.levels,this.selected_=s,this.handleQualityChange=this.handleQualityChange.bind(this),this.controlText(t.controlText),this.on(l,"change",this.handleQualityChange),this.on("dispose",()=>{this.off(l,"change",this.handleQualityChange)})}createEl(e,t,s){const l=super.createEl(e,t,s),n=p.createEl("span",{className:"vjs-quality-menu-item-sub-label",innerHTML:this.localize(this.options_.subLabel||"")});return this.subLabel_=n,l&&l.appendChild(n),l}handleClick(){this.updateSiblings_();const e=this.player().qualityLevels(),t=e.selectedIndex;for(let s=0,l=e.length;s<l;s++)s!==t&&(e[s].enabled=!1);for(let s=0,l=this.levels_.length;s<l;s++)e[this.levels_[s]].enabled=!0;t!==-1&&this.levels_.indexOf(t)===-1&&(e[t].enabled=!1)}handleQualityChange(){const e=this.player().qualityLevels(),t=this.levels_.indexOf(e.selectedIndex)>-1;this.selected(t)}selected(e){if(this.selectable)if(this.selected_){this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(this.localize("{1}, selected",this.localize(this.options_.controlText)));const s=this.player().controlBar.getChild("QualityMenuButton");e?s.removeClass("vjs-quality-menu-button-waiting"):s.addClass("vjs-quality-menu-button-waiting")}else this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(this.options_.controlText)}updateSiblings_(){const e=this.player().qualityLevels(),s=this.player().controlBar.getChild("QualityMenuButton").items;for(let l=0,n=s.length;l<n;l++){const a=s[l],r=a.levels_.indexOf(e.selectedIndex)>-1;a.selected_=a===this,a.selected(r)}}}const q=u.getComponent("MenuButton"),v=function(i){return Array.from(i).some(e=>e.height)},f=function(i){return i>=2160?"4K":i>=720?"HD":""};class L extends q{constructor(e,t={}){super(e,t),this.el_.setAttribute("aria-label",this.localize("Quality Levels")),this.controlText("Quality Levels"),e.options().experimentalSvgIcons||this.$(".vjs-icon-placeholder").classList.add("vjs-icon-cog"),this.setIcon("cog"),this.qualityLevels_=e.qualityLevels(),this.update=this.update.bind(this),this.hide=this.hide.bind(this),this.handleQualityChange_=this.handleQualityChange_.bind(this),this.firstChangeHandler_=this.firstChangeHandler_.bind(this),this.enableDefaultResolution_=this.enableDefaultResolution_.bind(this),this.on(this.qualityLevels_,"addqualitylevel",this.update),this.on(this.qualityLevels_,"removequalitylevel",this.update),this.on(this.qualityLevels_,"change",this.handleQualityChange_),this.one(this.qualityLevels_,"change",this.firstChangeHandler_),e.on("adstart",this.hide),e.on(["adend","adtimeout"],this.update),this.update(),this.on("dispose",()=>{this.off(this.qualityLevels_,"addqualitylevel",this.update),this.off(this.qualityLevels_,"removequalitylevel",this.update),this.off(this.qualityLevels_,"change",this.handleQualityChange_),this.off(this.qualityLevels_,"change",this.firstChangeHandler_),e.off("adstart",this.hide),e.off(["adend","adtimeout"],this.update),e.off("loadedmetadata",this.enableDefaultResolution_)})}buildWrapperCSSClass(){return`vjs-quality-menu-wrapper ${super.buildWrapperCSSClass()}`}buildCSSClass(){return`vjs-quality-menu-button ${super.buildCSSClass()}`}createItems(){const e=[];if(!(this.qualityLevels_&&this.qualityLevels_.length))return e;let t;if(this.options_.useResolutionLabels&&v(this.qualityLevels_)?(t=this.groupByResolution_(),this.addClass("vjs-quality-menu-button-use-resolution")):(t=this.groupByBitrate_(),this.removeClass("vjs-quality-menu-button-use-resolution")),t.length<=1)return[];t.forEach(l=>{l.levels.length&&(l.selectable=!0,e.push(new c(this.player(),l)))});const s=new c(this.player(),{levels:Array.prototype.map.call(this.qualityLevels_,(l,n)=>n),label:"Auto",controlText:"Auto",active:!0,selected:!0,selectable:!0});return this.autoMenuItem_=s,e.push(s),e}groupByResolution_(){const e={},t=[];for(let l=0,n=this.qualityLevels_.length;l<n;l++){const a=this.qualityLevels_[l],r=this.qualityLevels_.selectedIndex===l,h=a.height;if(!h)continue;let o;if(this.options_.resolutionLabelBitrates){const d=Math.round(a.bitrate/1e3);o=`${h}p @ ${d} kbps`}else o=h+"p";if(!e[o]){const d=f(h);e[o]={levels:[],label:o,controlText:o,subLabel:d},t.push({label:o,lines:h})}r&&(e[o].active=!0),e[o].levels.push(l)}t.sort((l,n)=>n.lines-l.lines);const s=[];return t.forEach(l=>{s.push(e[l.label])}),s}groupByBitrate_(){const e=[{levels:[],label:"HD",controlText:"High Definition"},{levels:[],label:"SD",controlText:"Standard Definition"}];for(let t=0,s=this.qualityLevels_.length;t<s;t++){const l=this.qualityLevels_[t],n=this.qualityLevels_.selectedIndex===t;let a;l.bitrate<this.options_.sdBitrateLimit?a=e[1]:a=e[0],n&&(a.active=!0),a.levels.push(t)}return!e[0].levels.length||!e[1].levels.length?[]:e}handleQualityChange_(){const e=this.qualityLevels_[this.qualityLevels_.selectedIndex],t=this.options_.useResolutionLabels&&v(this.qualityLevels_);let s="";e&&(t?s=f(e.height):e.bitrate>=this.options_.sdBitrateLimit&&(s="HD")),s==="HD"?(this.addClass("vjs-quality-menu-button-HD-flag"),this.removeClass("vjs-quality-menu-button-4K-flag")):s==="4K"?(this.removeClass("vjs-quality-menu-button-HD-flag"),this.addClass("vjs-quality-menu-button-4K-flag")):(this.removeClass("vjs-quality-menu-button-HD-flag"),this.removeClass("vjs-quality-menu-button-4K-flag")),this.autoMenuItem_&&(this.autoMenuItem_.manuallySelected_&&e?this.autoMenuItem_.subLabel_.innerHTML=this.localize(s):this.autoMenuItem_.subLabel_.innerHTML="")}enableDefaultResolution_(){const e=this.options_.defaultResolution;for(let t=0;t<this.items.length;t++)this.items[t].options_.label.indexOf(e)!==-1&&this.items[t].handleClick()}firstChangeHandler_(){if(this.player_.readyState()<1&&this.player_.preload()!=="none"){this.player_.one("loadedmetadata",this.enableDefaultResolution_);return}this.enableDefaultResolution_()}}u.registerComponent("QualityMenuButton",L);var b="1.0.3";const C={sdBitrateLimit:2e6,useResolutionLabels:!0,resolutionLabelBitrates:!1,defaultResolution:"none"},y=(i,e)=>{i.addClass("vjs-quality-menu");const t=i.getChild("controlBar"),s=t.addChild("QualityMenuButton",e,t.children_.length-2);return function(){i.removeClass("vjs-quality-menu"),t.removeChild(s),s.dispose()}},B=function(i,e){if(typeof i.qualityLevels<"u"){i.qualityLevels();let t=()=>{};i.ready(()=>{t=y(i,e),i.on("loadstart",()=>{t(),t=y(i,e)})}),i.qualityMenu=()=>{},i.qualityMenu.VERSION=b}},g=function(i){B(this,u.obj.merge(C,i))};u.registerPlugin("qualityMenu",g);g.VERSION=b;const x=_("video-element-id",{plugins:{qualityMenu:!0}});x.src({src:"urn:rts:video:9883196",type:"srgssr/urn"});document.querySelector("#close-btn").addEventListener("click",()=>{window.close()});window.pillarbox=_;
//# sourceMappingURL=quality-menu-DM-8h2uQ.js.map
