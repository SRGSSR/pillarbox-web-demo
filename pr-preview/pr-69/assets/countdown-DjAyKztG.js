import{p as n}from"./core-demo-header-component-CXdk6c17.js";const p=n.getComponent("ModalDialog");class S extends p{constructor(t,o){const r=n.obj.merge(o,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});super(t,r),this.intervalId=void 0,this.reset=this.reset.bind(this),this.on(t,["loadstart","playerreset","dispose","error"],this.reset)}buildCSSClass(){return`pillarbox-countdown ${super.buildCSSClass()}`}dispose(){this.reset(),this.off(this.player(),["loadstart","playerreset","dispose","error"],this.reset),super.dispose()}reset(){this.clearInterval(this.intervalId),this.close(),this.empty(),this.intervalId=void 0}start(t,o){if(this.reset(),typeof t=="number")return this.intervalId=this.setInterval(()=>{const r=this.remainingDuration(t);if(r.totalInMilliseconds<=0){this.reset(),this.player().src(o);return}this.fillWith(`${r.days}d ${r.hours}h ${r.minutes}m ${r.seconds}s remaining`)},1e3),this.open(),!0}remainingDuration(t){const a=t-Date.now();let s=a,l=Math.floor(s/864e5);s-=l*864e5;let d=Math.floor(s/36e5);s-=d*36e5;let u=Math.floor(s/6e4);s-=u*6e4;let c=Math.floor(s/1e3);return{days:l.toString().padStart(2,"0"),hours:d.toString().padStart(2,"0"),minutes:u.toString().padStart(2,"0"),seconds:c.toString().padStart(2,"0"),totalInMilliseconds:a}}}n.registerComponent("Countdown",S);const e=n("video-element-id",{muted:!0,fill:!0,countdown:!0});e.on("error",()=>{const{metadata:i={}}=e.error()||{};if(i.errorType!=="STARTDATE")return;const{src:{mediaData:{chapters:[{validFrom:t}={}]=[]}={}}={}}=i,o=new Date(t).getTime();e.countdown.start(o,e.currentSource())&&e.errorDisplay&&e.errorDisplay.opened()&&e.errorDisplay.close()});e.countdown.start(Date.now()+5977235e3,{src:"urn:rts:video:10894383",type:"srgssr/urn"});window.player=e;document.querySelector("#close-btn").addEventListener("click",()=>{window.close()});window.pillarbox=n;
//# sourceMappingURL=countdown-DjAyKztG.js.map
