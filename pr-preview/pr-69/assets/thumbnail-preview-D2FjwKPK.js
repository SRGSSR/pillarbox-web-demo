import{v as n,p as w}from"./core-demo-header-component-Cvya-StE.js";const B="1.0.0";function P(i,t,e){if(typeof i=="function"?i===t:i.has(t))return arguments.length<3?t:e;throw new TypeError("Private element is not present on this object")}function x(i,t){if(t.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(i,t){return i.get(P(i,t))}function p(i,t,e){x(i,t),t.set(i,e)}function y(i,t,e){return i.set(P(i,t),e),e}const _=n.getComponent("Component"),f=n.log.createLogger("thumbnail-preview-overlay");var u=new WeakMap,d=new WeakMap,v=new WeakMap,b=new WeakMap,h=new WeakMap;class m extends _{constructor(t,e={}){super(t,e),p(this,u,()=>this.resetThumbnailPosition()),p(this,d,s=>this.onMove(s)),p(this,v,()=>this.updateThumbnailVisibility()),p(this,b,()=>this.resetSprite()),p(this,h,!1),this.player().on("emptied",r(b,this))}init(){this.options().sprite.url?(this.initListeners(),this.resizeThumbnail(),this.thumbnail.src=this.options().sprite.url,this.updateThumbnailVisibility()):this.resetSprite()}getProgressControl(){var t;return(t=this.player().controlBar)===null||t===void 0?void 0:t.progressControl}updateSprite(t){this.options({sprite:t}),this.init()}resetSprite(){this.removeListeners(),this.hide()}initListeners(){if(r(h,this))return;const t=this.getProgressControl();t.on("pointermove",r(d,this)),t.on("pointerleave",r(u,this)),this.player().on("userinactive",r(u,this)),this.player().on("playerresize",r(v,this)),y(h,this,!0)}removeListeners(){if(!r(h,this))return;const t=this.getProgressControl();t.off("pointermove",r(d,this)),t.off("pointerleave",r(u,this)),this.player().off("userinactive",r(u,this)),this.player().off("playerresize",r(v,this)),y(h,this,!1)}dispose(){this.player().off("empty",r(b,this)),this.removeListeners(),super.dispose()}updateThumbnailVisibility(){const t=this.player().currentDimension("height");if(this.resizeThumbnail(),t<this.options().displayThresholdHeight){this.hide();return}this.show()}resetThumbnailPosition(){var t;setTimeout(()=>{this.el().style.transform="translateX(-1000px)"},(t=this.options().resetPositionDelay)!==null&&t!==void 0?t:300)}onMove(t){const e=this.getProgressControl();if(!e){f.error("progressControl is missing or invalid during mouse move.");return}const s=n.dom.getBoundingClientRect(e.el()),o=m.calculatePointBoundary(n.dom.getPointerPosition(e.el(),t).x),a=this.calculateThumbnailHolderPosition(s,o),l=Math.floor(this.player().duration()*o);this.el().style.transform=`translateX(${a}px)`,this.calculateFrame(l)}static calculatePointBoundary(t){return Math.max(0,Math.min(t,1))}calculateThumbnailHolderPosition(t,e){let s=t.width*e-this.width()/2;const o=28,a=t.right-this.width()-o,l=t.left*-1+o;return Math.max(l,Math.min(a,s))}calculateFrame(t){const{interval:e,columns:s,thumbnailHeight:o,thumbnailWidth:a}=this.options().sprite,l=Math.floor(t/(e/1e3)),C=Math.floor(l/s),S=l%s,T=C*o*this.coef,M=S*a*this.coef,g=this.$(".pbw-thumbnail");g.style.left=`${-M}px`,g.style.top=`${-T}px`}resizeThumbnail(){const t=this.player().currentBreakpoint(),{thumbnailWidth:e,thumbnailHeight:s,columns:o}=this.options().sprite;this.coef=this.options().breakpointsCoeficients[t]||1,this.el().style.width=`${e*this.coef}px`,this.el().style.height=`${s*this.coef}px`,this.thumbnail.width=e*o*this.coef}createEl(t="div",e={},s={}){if(t!=="div")throw f.error(`Creating a ThumbnailPreview with an HTML element of ${t} is not supported; the element must be a 'div'`),new Error(`'${t}' is not supported for ThumbnailPreview`);return this.thumbnail=n.dom.createEl("img",{className:"pbw-thumbnail",src:this.options().sprite.url}),n.dom.createEl(t,n.obj.merge({className:this.buildCSSClass()},e),s,this.thumbnail)}buildCSSClass(){return`${super.buildCSSClass()} pbw-thumbnail-preview`}get active(){return r(h,this)}}m.prototype.options_={className:"pbw-thumbnail-preview",displayThresholdHeight:279,resetPositionDelay:300,breakpointsCoeficients:{huge:1.7,xlarge:1.7,large:1.4,medium:1.3,small:1.2,xsmall:1,tiny:1},sprite:{rows:1,columns:1,thumbnailWidth:0,thumbnailHeight:0,interval:1e4}};n.registerComponent("ThumbnailPreviewOverlay",m);const $=n.getPlugin("plugin"),k=n.log.createLogger("thumbnail-preview");class O extends ${constructor(t,e){if(super(t),this.isProgressControlDisabled()){k.error("Cannot initialize because no ProgressControl component was found in the playerâ€™s ControlBar. Make sure the player is configured with controlBar.progressControl enabled.");return}e=this.options_=n.obj.merge(this.options_,e),this.player.options({controlBar:{progressControl:{thumbnailPreviewOverlay:e}}}),this.player.ready(()=>{const s=this.player.controlBar.progressControl;this.thumbnailPreviewOverlay=s.thumbnailPreviewOverlay,this.thumbnailPreviewOverlay.init()})}isProgressControlDisabled(){var t;const e=this.player.options();return e.controlBar===!1||((t=e.controlBar)===null||t===void 0?void 0:t.progressControl)===!1||e.children&&!e.children.includes("controlBar")}updateSprite(t){this.thumbnailPreviewOverlay.updateSprite(t)}resetSprite(){this.thumbnailPreviewOverlay.resetSprite()}static get VERSION(){return B}}n.registerPlugin("thumbnailPreview",O);const c=w("video-element-id",{plugins:{thumbnailPreview:{}}});c.on("loadedmetadata",()=>{var e,s,o;const i=c.thumbnailPreview(),t=(o=(s=(e=c.currentSource().mediaData)==null?void 0:e.chapters)==null?void 0:s.find(a=>a.urn==="urn:rts:video:15532586"))==null?void 0:o.spriteSheet;if(!t||!t.url){i.resetSprite();return}i.updateSprite(t)});c.src({src:"urn:rts:video:15532586",type:"srgssr/urn"});document.querySelector("#close-btn").addEventListener("click",()=>{window.close()});window.pillarbox=w;
//# sourceMappingURL=thumbnail-preview-D2FjwKPK.js.map
